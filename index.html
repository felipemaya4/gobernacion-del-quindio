<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script type="text/javascript" src="pdfmake.min.js"></script>
    <title>Formulario de estudios previos contrato prestacion de servicios</title>
</head>
<body>
    <h1>Formulario de estudios previos contrato prestacion de servicios</h1>
    <div>
        <form id="formulario" action="" method="post">
            <label for="numeroPrecontractual">numero planeacion Precontractual</label>
            <input type="number" name="numeroPrecontractual" id="numeroPrecontractual" >
            <br>
            <label for="dependencia">Dependencia</label>
            <select name="dependencia" id="dependencia">
                <option value="juridica">Juridica</option>
                <option value="administrativa">Administrativa</option>
            </select>
            <br>
            <label for="">tipo de contrato a celebrar</label>
            <select name="tipoContrato" id="tipoContrato">
                <option value="profesionales">Profesionales</option>
                <option value="apoyo a la gestion">Apoyo a la gestion</option>
            </select>
            <br>
            <label for="justificacion">justificacion actividad</label>
            <br>    
            <textarea name="justificacion" id="justificacion" cols="60" rows="15" placeholder="A partir de acá, se deberá de realizar la respectiva justificación de la necesidad que se esta presentando, misma que da origen al proceso de selección, a su vez, deberá de indicar como se pretende satisfacer o, por medio de que profesional ejecutará el futuro contrato.&nbsp;Ahora bien, en el caso de futuros contratistas personas naturales profesionales con posgrados, deberá de justificar los motivos por medio de los cuales se requiere dicha especialidad para satisfacer la necesidad presentada"></textarea>
            <br>
            <label for="objetoContrato">objeto de contrato a celebrar</label>
            <br>
            <textarea name="objetoContrato" id="objetoContrato" cols="30" rows="10" placeholder="Para definir el objeto deberá de tener en cuenta la tipología contractual a emplear, las obligaciones específicas, la meta o proyecto a ejecutar"></textarea>
            <br>
            <label for="plazoEjecucion">Plazo de ejecucion</label>
            <input type="number" name="plazoEjecucion" id="plazoEjecucion">
            <br>
            <label for="valorContrato">valor del contrato</label>
            <input type="number" name="valorContrato" id="valorContrato">
            <br>
            <label for="formaPago">Forma de pago</label>
            <br>
            <label for="cantidadCuotas">cantidad de cuotas</label> <input type="number" name="cantidadCuotas" id="cantidadCuotas">
            <p hidden >mostrar el valor de cada cuota </p>
            <br>
            <label for="frecuenciaPagos">frecuencia de pagos en dias</label><input type="number" name="frecuenciaPagos" id="frecuenciaPagos">
            <br>
            <label for="cdp">numero CDP</label>
            <input type="number" name="cdp" id="cdp">
            <br>
            <label for="fechaCdp">fecha</label>
            <input type="date" name="fechaCdp" id="fechaCdp">
            <label for="cargoFuncionario">Cargo</label>
            <select name="cargoFuncionario" id="cargoFuncionario">
                <option value="pendiente">pendiente</option>
            </select>
            <label for="gradoFuncionario">Grado</label>
            <select name="gradoFuncionario" id="gradoFuncionario">
                <option value="01">01</option>
                <option value="02">02</option>
                <option value="03">03</option>
                <option value="04">04</option>
                <option value="05">05</option>
                <option value="06">06</option>
                <option value="07">07</option>
                <option value="08">08</option>
                <option value="09">09</option>
                <option value="10">10</option>    
            </select>
            <br>
            <label for="obligacionesContratista">Obligaciones del contratista</label>
            <br>
            <input type="text" name="obligacionesContratista" id="obligacionesContratista" placeholder="ingrese aquí una a una las obligaciones del contratista" >
            <input type="button" id="agregarObligacion"  value="agregar">
            <br>
            <ol id="listaObligaciones">
            </ol>
            <br>
            <label for="idoneidad">Idoneidad</label>
            <br>
            <textarea name="idoneidad" id="idoneidad" cols="30" rows="10" placeholder="Deberá de incluir que estudios que se solicitarán al futuro contratista, en caso de profesiones reguladas, deberá de solicitar la respectiva tarjeta profesional vigente"></textarea>
            <br>
            <label for="experiencia">Experiencia</label>
            <br>
            <textarea name="experiencia" id="experiencia" cols="30" rows="10" placeholder="Deberá de incluir la experiencia que se le solicitará al futuro contratista, esta puede ser laboral, profesional, relacionada, profesional relacionada, etc" ></textarea>
            <br>
            <label for="nombreOrdenador">Nombre del ordenador del gasto</label>
            <br>
            <input type="text" name="nombreOrdenador" id="nombreOrdenador">
            <input type="submit" value="Generar Documento">
           
        </form>

    </div>
    
    <a href="javascript:genPdf()">generar pdf</a>
    <script type="text/javascript">
       /* function genPdf(){
            let doc = new jsPDF();
            doc.text(20,20,"hola mundo");
            doc.text()
            doc.save('my.pdf');

        }*/
        let formulario =document.getElementById('formulario');
        let agregarObligacion = document.getElementById('agregarObligacion');
        let obligacionesContratista = document.getElementById('obligacionesContratista');
        let listaObligaciones = document.getElementById('listaObligaciones');
        let obligacionesValues = [];
        let indice = 0;
        //devuelve en letras el mes dado en numeros
        function mes(m){
            switch (m) {
                case '01':
                    return 'enero'
                    break;
                case '02':
                    return 'febrero'
                    break;
                case '03':
                    return 'marzo'
                    break;
                case '04':
                    return 'abril'
                    break;
                case '05':
                    return 'mayo'
                    break;
                case '06':
                    return 'junio'
                    break;
                case '07':
                    return 'julio'
                    break;
                case '08':
                    return 'agosto'
                    break;
                case '09':
                    return 'septiembre'
                    break;
                case '10':
                    return 'octubre'
                    break;
                case '11':
                    return 'noviembre'
                    break;
                case '12':
                    return 'diciembre'
                    break;
                case '1':
                    return 'enero'
                    break;
                case '2':
                    return 'febrero'
                    break;
                case '3':
                    return 'marzo'
                    break;
                case '4':
                    return 'abril'
                    break;
                case '5':
                    return 'mayo'
                    break;
                case '6':
                    return 'junio'
                    break;
                case '7':
                    return 'julio'
                    break;
                case '8':
                    return 'agosto'
                    break;
                case '9':
                    return 'septiembre'
                    break;
                default:
                    break;
            }
        }
        // fecha en formato " dia de mes de año"
        function fechaCDP(fecha) {

            let year = fecha.slice(0,4);
            let month = fecha.slice(5,7);
            let day = fecha.slice(8);
            let fechaCDP;
            let mesLetras = mes(month);
            fechaCDP = day + ' de '+mesLetras+' de '+ year;
            return fechaCDP
        }
        
        //obtener datos del formulario
        formulario.addEventListener('submit', function(e){
            e.preventDefault();
            let fechaCdp = fechaCDP(document.getElementById('fechaCdp').value)
            let fechaRealizacion = new Date();
            let mesRealizacion = mes(fechaRealizacion.getMonth().toString());
            let fechaRealizacionLetras = fechaRealizacion.getDay().toString()+' de '+ mesRealizacion  +' de '+fechaRealizacion.getFullYear().toString();
            let contenidoFormulario ={

                numeroPrecontractual : document.getElementById('numeroPrecontractual').value,
                fechaRealizacion : fechaRealizacionLetras,
                dependencia : document.getElementById('dependencia').value,
                tipoContrato : document.getElementById('tipoContrato').value,
                objetoContrato : document.getElementById('objetoContrato').value,
                plazoEjecucion : document.getElementById('plazoEjecucion').value,
                valorContrato : document.getElementById('valorContrato').value,
                catidadCuotas : document.getElementById('cantidadCuotas').value,
                frecuenciaPagos : document.getElementById('frecuenciaPagos').value,
                cdp : document.getElementById('cdp').value,
                fechaCdp :fechaCdp,
                cargoFuncionario : document.getElementById('cargoFuncionario').value,
                gradoFuncionario : document.getElementById('gradoFuncionario').value,
                listaObligaciones : [],
                idoneidad : document.getElementById('idoneidad').value,
                experiencia : document.getElementById('experiencia').value,
                nombreOrdenador : document.getElementById('nombreOrdenador').value,
                vigenciaFiscal : new Date().getFullYear().toString(),

            }

            let lista = document.querySelectorAll('li')
            // obtener los valores de la lista de obligaciones para insertar en el objeto del formulario
            lista.forEach(function (li) {
                let text = li.firstChild.textContent; 
                contenidoFormulario.listaObligaciones.push({text:text,bold:false});
            })
            console.log('contenidoFormulario :>> ', contenidoFormulario);
        });

        //agregar item a la lista de obligaciones conboton de borrar
        agregarObligacion.addEventListener('click', function(e){
            e.preventDefault();
            if(obligacionesContratista.value == '')
            {
                console.log('inserte datos');
            }else{
                // creacion de elementos li y button
                let nuevaObligacion = document.createElement('li');
                let botonBorrar = document.createElement('button');
                // insercion de valores en li y array para manipulacion txt de nueva obligacion
                nuevaObligacion.textContent  = obligacionesContratista.value;
                nuevaObligacion.id = 'obligacion'+ indice.toString();
                //configuracion de boton de borrado
                botonBorrar.textContent = 'borrar';
                botonBorrar.id = 'borrar';
                botonBorrar.value = indice;
                botonBorrar.onclick = function(e){
                    e.preventDefault();
                    let nodo = document.getElementById('listaObligaciones'); // nodo padre
                    let item = document.getElementById(nuevaObligacion.id); // nodo hijo 
                    nodo.removeChild(item); // eliminacion de nodo hijo del padre
                }
                indice ++;
                console.log(nuevaObligacion,indice);

                //insercion de elementos en la lista "ol"
                listaObligaciones.appendChild(nuevaObligacion).appendChild(botonBorrar);
                //se borrar el valor del input para evitar entradas repetidas
                obligacionesContratista.value='';

            }
           
        })


    </script>
</body>
</html>